{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommitTypeAll(chore)",
    ":semanticCommitScope(deps)",
    "group:allNonMajor"
  ],
  "timezone": "America/New_York",
  "schedule": ["before 5am on Monday"],
  "labels": ["dependencies"],
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security"],
    "commitMessageSuffix": "[SECURITY]"
  },
  "packageRules": [
    {
      "description": "Require approval for major updates",
      "matchUpdateTypes": ["major"],
      "dependencyDashboardApproval": true
    },
    {
      "description": "Group Python dependencies by app",
      "matchManagers": ["pep621"],
      "matchPaths": ["apps/api/**"],
      "groupName": "api Python dependencies",
      "commitMessageTopic": "api Python deps"
    },
    {
      "description": "Group demo apps Python dependencies",
      "matchManagers": ["pep621"],
      "matchPaths": ["apps/demo/**", "apps/demo-otel-agent/**"],
      "groupName": "demo Python dependencies",
      "commitMessageTopic": "demo Python deps",
      "automerge": true,
      "automergeType": "pr",
      "matchUpdateTypes": ["patch", "minor"]
    },
    {
      "description": "Group documentation dependencies",
      "matchManagers": ["pip_requirements"],
      "matchPaths": ["docs/**"],
      "groupName": "docs Python dependencies",
      "commitMessageTopic": "docs Python deps"
    },
    {
      "description": "Group Go dependencies",
      "matchManagers": ["gomod"],
      "matchPaths": ["apps/opamp-server/**"],
      "groupName": "opamp Go dependencies",
      "commitMessageTopic": "opamp Go deps"
    },
    {
      "description": "Group npm dependencies",
      "matchManagers": ["npm"],
      "matchPaths": ["apps/web-ui/**"],
      "groupName": "web-ui npm dependencies",
      "commitMessageTopic": "web-ui npm deps"
    },
    {
      "description": "Group Docker base image updates",
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["minor", "patch", "digest"],
      "groupName": "Docker base images"
    },
    {
      "description": "Pin critical infrastructure versions",
      "matchPackageNames": ["postgres", "postgresql"],
      "matchDatasources": ["docker"],
      "enabled": false
    },
    {
      "description": "Exclude ollyscale containers (managed by release process)",
      "matchPackagePatterns": ["ghcr.io/ryanfaircloth/ollyscale/*", "ollyscale/*"],
      "matchDatasources": ["docker"],
      "enabled": false
    },
    {
      "description": "Exclude ollyscale Helm charts (managed by release process)",
      "matchPackagePatterns": ["ollyscale*"],
      "matchDatasources": ["helm"],
      "enabled": false
    }
  ]
}
